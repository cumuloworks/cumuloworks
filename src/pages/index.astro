---
import { Icon } from "astro-icon/components";
import TopPageBackground from "../components/toppage/TopPageBackground.astro";
import TopPageGallery from "../components/toppage/TopPageGallery.astro";
import TopPageInteractions from "../components/toppage/TopPageInteractions.astro";
import BaseLayout from "../layouts/BaseLayout.astro";
import { categoryDictionary } from "../utils/categoryNameDictionary";
import { getItemsWithThumbnails } from "../utils/contentUtils";

const projects = await getItemsWithThumbnails("projects");

const categoryDescriptions = {
	ads: "Advertisements and promotional videos for businesses.",
	entertainment:
		"Music videos, live productions, and other entertainment content.",
	uncategorized: "Projects in this category",
};

const projectsByCategory = projects.reduce((acc, project) => {
	const category = project.data.category || "uncategorized";
	if (!acc[category]) {
		acc[category] = {
			projects: [],
			description: categoryDescriptions[category],
		};
	}
	acc[category].projects.push(project);
	return acc;
}, {});
---

<BaseLayout
	title="Home"
	description="Cumuloworks | Director / Motion Grapher / CG Generalist"
	limit={false}
	header={false}>
	<div
		class="flex flex-col snap-y snap-mandatory from-cumulodark to-black bg-gradient-to-b">
		<section class="w-full h-svh bg-cumulodark relative snap-start">
			<TopPageBackground />
			<TopPageInteractions />
		</section>
		<section
			class="min-h-[calc(100svh-40px)] snap-start max-w-screen-xl mx-auto p-8 flex flex-col justify-center font-bold text-inactive">
			<div
				class="grid grid-cols-1 md:grid-cols-2 gap-x-10 gap-y-20 py-20">
				{
					Object.entries(projectsByCategory).map(
						([category, projectsData]) => (
							<TopPageGallery
								category={categoryDictionary[category]}
								description={projectsData.description}
								projects={projectsData.projects}
							/>
						),
					)
				}
			</div>
			<a
				href="/projects"
				class="flex items-center gap-5 justify-center md:justify-end uppercase mb-5 group h-10"
				>Show more projects
				<Icon
					name="fa6-solid:chevron-right"
					class="size-5 group-hover:size-10 transition-all ease-out-expo"
				/>
			</a>
		</section>
	</div>
</BaseLayout>
